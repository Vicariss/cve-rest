import pytest


# run for each touple in decorator
@pytest.mark.parametrize("amount",[("2001"), ("893248723487"), ("3478534875")])
def test_too_many_cve_fail(test_client, amount):
    """
    GIVEN get API call 
    WHEN too many CVEs are requested
    THEN check if the amount of CVEs is right
    """
    response = test_client.get(f'/cve?amount={amount}')
    assert b"You've requested too many CVEs at once. Max is 2000." in response.data
    